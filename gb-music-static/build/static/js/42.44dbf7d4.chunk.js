(this["webpackJsonpgb-music-react"]=this["webpackJsonpgb-music-react"]||[]).push([[42],{106:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h}));var r=n(174),a=n.n(r),o=n(175),u=n(499),i=n(115),s=n(108),c=n(45);function d(e){return{type:"changeUserMsg",userMsg:e}}function l(e){return{type:"changeLoginType",loginType:e}}function g(){return function(e){Object(s.f)().then((function(t){var n=t.love,r=t.follow;n||(t.love=[]),r||(t.follow=[]),window.localStorage.setItem("userDetail",JSON.stringify(t)),e({type:"changeUserDetail",userDetail:t})}))}}function f(e,t,n){return function(){var r=Object(o.a)(a.a.mark((function r(o){var f,h;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(i.a)(e,t);case 3:if(!(f=r.sent)){r.next=19;break}return h=f.token,r.next=8,Object(s.l)(h);case 8:return 1*r.sent.code===200&&(o(Object(c.a)("\u60a8\u7684VIP\u5df2\u7ecf\u8fc7\u671f\uff0c\u5f00\u901aVIP\u540e\u7545\u60f3",3500)),f.auth=0,delete f.vip),r.next=12,o(d(f));case 12:return r.next=14,o(l(1));case 14:return window.localStorage.setItem("userMsg",JSON.stringify(f)),window.localStorage.setItem("loginType","1"),r.next=18,o(g());case 18:n.history.push({pathname:"/Home"});case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(0),console.log(r.t0),u.b.warning({content:"\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef",style:{fontSize:"20px",marginTop:"5vh"}});case 25:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(e){return r.apply(this,arguments)}}()}function h(){return function(e){window.localStorage.clear(),e(l(0)),e(d({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),e({type:"changeUserDetail",userDetail:{userId:"",userName:"",avatarUrl:"",subscriber:[],thumb:[],follow:[{userId:""}],love:[{songId:""}]}})}}},108:function(e,t,n){"use strict";n.d(t,"k",(function(){return o})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"m",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return g})),n.d(t,"j",(function(){return f})),n.d(t,"l",(function(){return h})),n.d(t,"h",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return m}));var r=n(97),a=n(22);function o(e){return Object(r.a)({url:"/user/favorite",method:"post",data:{id:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(e,t){return Object(r.a)({url:"/user/favorite",params:{offset:e,limit:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function i(e){return Object(r.a)({url:"/user/favorite/cancel",method:"post",data:{songId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function s(e,t,n){return Object(r.a)({url:"/sub/user/".concat(e),params:{offset:t,limit:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function c(){return Object(r.a)({url:"/user/detail",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function d(e){return Object(r.a)({url:"/user/upload/avatar",method:"post",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-Type":"multipart/form-data"},data:e})}function l(e){return Object(r.a)({url:"/user/other/detail",method:"post",data:{userId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function g(e,t,n){return Object(r.a)({url:"/user/channel",method:"post",data:{userId:e,offset:t,limit:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function f(e,t,n){return Object(r.a)({url:"/sub/user/playlist",method:"post",params:{offset:t,limit:n},data:{userId:e}})}function h(e){return Object(r.a)({url:"/user/expire",method:"post",headers:{authorization:e}})}function p(){return Object(r.a)({url:"/user/data/moment",method:"post",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function b(e,t){return Object(r.a)({url:"/user/moment",method:"post",data:{offset:e,limit:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function m(e){return Object(r.a)({url:"/user/simple",params:{userId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},115:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(97);function a(e,t){return Object(r.a)({url:"/login",method:"post",data:{userName:e,password:t}})}function o(e,t){return Object(r.a)({url:"/register",method:"post",data:{userName:e,password:t}})}},122:function(e,t,n){"use strict";function r(e,t){var n=new Date(e);/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));var r={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds()};for(var o in r)if(new RegExp("(".concat(o,")")).test(t)){var u=r[o]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?u:a(u))}return t||""}function a(e){return("00"+e).substr(e.length)}n.d(t,"a",(function(){return r}))},146:function(e,t,n){"use strict";var r=n(94),a=n(0),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z"}}]},name:"check",theme:"outlined"},u=n(95),i=function(e,t){return a.createElement(u.a,Object(r.a)(Object(r.a)({},e),{},{ref:t,icon:o}))};i.displayName="CheckOutlined";t.a=a.forwardRef(i)},257:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(48);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,u=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw u}}}}},414:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(97),a=n(22);function o(){return Object(r.a)({url:"/combo/all",method:"get",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(e,t,n){return Object(r.a)({url:"/pay/join",method:"post",data:{name:t,cId:e,orderId:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function i(){return Object(r.a)({url:"/vip",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function s(){return Object(r.a)({url:"/vip/history",method:"post",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function c(e){return Object(r.a)({url:"/vip/history/delete",method:"post",data:{id:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},415:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var r=n(97),a=n(22);function o(e,t,n){return Object(r.a)({url:"/pay",method:"post",data:{price:e,name:t,cId:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(e){return Object(r.a)({url:"/pay/query",method:"post",data:{orderId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},531:function(e,t,n){"use strict";n.r(t);var r,a=n(40),o=n(0),u=n(3),i=n(10),s=n(146),c=n(11),d=n(12).a.div(r||(r=Object(c.a)(["\n  background-color: #fff;\n  border-left: 1px solid #d3d3d3;\n  border-right: 1px solid #d3d3d3;\n  width: 800px;\n  margin: 0 auto;\n  padding: 100px 0 150px 0;\n  display: flex;\n  align-items: center;\n  flex-direction: column-reverse;\n  .success-icon {\n    border: 3px solid #f27a7a;\n    width: 80px;\n    height: 80px;\n    border-radius: 50%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    .already {\n      color: #f27a7a;\n      svg {\n        font-size: 30px;\n      }\n    }\n  }\n  .tip {\n    text-align: center;\n    font-weight: bolder;\n    margin: 20px 0 0 0;\n  }\n  .success-msg {\n    width: 170px;\n    margin: 15px 0 0 0;\n    & > li {\n      text-align: center;\n      margin: 0 0 5px 0;\n      span {\n        margin: 0 5px 0 0;\n        &:nth-child(2) {\n          font-weight: bold;\n        }\n      }\n    }\n  }\n  .known {\n    margin: 30px 0 0 0;\n    background-color: #fb5e5a;\n    color: #fff;\n    padding: 5px 70px;\n    border-radius: 15px;\n    cursor: pointer;\n  }\n"]))),l=n(257);var g=n(415),f=n(414),h=n(122),p=n(106),b=n(2),m=function(e){var t=Object(o.useState)({}),n=Object(a.a)(t,2),r=n[0],u=n[1],c=Object(o.useState)({}),m=Object(a.a)(c,2),j=m[0],O=m[1],v=Object(i.c)((function(e){return{userMsg:e.getIn(["loginReducer","login","userMsg"])}})).userMsg,x=Object(i.b)();Object(o.useEffect)((function(){var e=function(e){if(e.includes("?")){var t,n=e.substring(e.lastIndexOf("?")+1).split("&"),r={},a=Object(l.a)(n);try{for(a.s();!(t=a.n()).done;){var o=t.value.split("=");r[o[0]]=o[1].toString()}}catch(u){a.e(u)}finally{a.f()}return r}return""}(window.location.href);u(e),j.price=e.out_trade_no.split("_")[1],j.name=e.out_trade_no.split("_")[2]+"\u4e2a\u6708",j.expireTime=(new Date).getTime()+60*parseInt(e.out_trade_no.split("_")[2])*60*24*30*1e3,O(j),Object(g.b)(e.out_trade_no).then((function(t){if(1*t.code===1e4){var n=e.out_trade_no.split("_")[0];Object(f.e)(n,j.name,e.orderId).then((function(e){Object(f.d)().then((function(e){e.token=v.token,x(Object(p.b)(e)),window.localStorage.setItem("userMsg",JSON.stringify(e))}))}))}}))}),[x,j,v.token]);return Object(b.jsxs)(d,{children:[Object(b.jsx)("div",{className:"known",onClick:function(t){e.history.push({pathname:"/Home/discover/recommend"})},children:"\u77e5\u9053\u4e86"}),Object.keys(j).length&&Object(b.jsxs)("ul",{className:"success-msg",children:[Object(b.jsxs)("li",{children:[Object(b.jsx)("span",{children:"\u5b9e\u4ed8\u91d1\u989d :"}),Object(b.jsx)("span",{children:r.total_amount})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("span",{children:"\u8d2d\u4e70\u4f1a\u5458 :"}),Object(b.jsx)("span",{children:j.name})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("span",{children:"\u5230\u671f\u65f6\u95f4 :"}),Object(b.jsx)("span",{children:Object(h.a)(j.expireTime,"yyyy-MM-dd")})]})]}),Object(b.jsx)("p",{className:"tip",children:"\u5f00\u901a\u6210\u529f"}),Object(b.jsx)("div",{className:"success-icon",children:Object(b.jsx)(s.a,{className:"already"})})]})};t.default=Object(u.h)(Object(o.memo)(m))},97:function(e,t,n){"use strict";var r=n(173),a=n.n(r),o=n(26),u=n(22),i=n(106),s=n(9);t.a=function(e){var t=a.a.create({baseURL:o.a,timeout:15e3});return t.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),e})),t.interceptors.response.use((function(e){return e.data}),(function(e){if(e.response){var t=e.response,n=t.status,r=t.data;if(1*n!==403||"\u8bf7\u767b\u5f55"!==r.message)throw e;u.a.dispatch(Object(i.d)()),u.a.dispatch(Object(i.b)({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),Object(s.a)().push({pathname:"/Login"})}})),t.request(e)}}}]);
//# sourceMappingURL=42.44dbf7d4.chunk.js.map