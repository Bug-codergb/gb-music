(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d783e4a"],{1634:function(e,t,a){"use strict";a("92df")},"20ca":function(e,t,a){"use strict";function s(e,t,a){var s=null,i=function(){var i=this,n=arguments;if(s&&clearTimeout(s),a){var r=!s;s=setTimeout((function(){s=null}),t),r&&e.apply(i,n)}else s=setTimeout((function(){e.apply(i,n)}),t)};return i.remove=function(){clearTimeout(s),s=null},i}a.d(t,"a",(function(){return s}))},"231d":function(e,t,a){"use strict";a("34b5")},"34b5":function(e,t,a){},"50d3":function(e,t,a){"use strict";a("ee26")},"92df":function(e,t,a){},9419:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user"},[a("UserHeader"),a("div",{staticClass:"header-controller"},[a("el-input",{attrs:{placeholder:"请输入用户名称",clearable:""},on:{input:e.inpSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),a("el-select",{on:{change:e.vipChange},model:{value:e.isVip,callback:function(t){e.isVip=t},expression:"isVip"}},[a("el-option",{attrs:{label:"全部",value:-1}}),a("el-option",{attrs:{label:"vip用户",value:1}}),a("el-option",{attrs:{label:"非vip用户",value:0}})],1),a("el-select",{on:{change:e.manageChange},model:{value:e.isManage,callback:function(t){e.isManage=t},expression:"isManage"}},[a("el-option",{attrs:{label:"全部",value:-1}}),a("el-option",{attrs:{label:"管理员",value:1}}),a("el-option",{attrs:{label:"普通用户",value:0}})],1)],1),a("ul",{staticClass:"user-list"},e._l(e.userList,(function(t,s){return a("li",{key:t.id},[a("div",{staticClass:"index"},[e._v(e._s((s+1).toString().padStart(2,"0")))]),a("div",{staticClass:"user-name"},[e._v(e._s(t.userName))]),a("div",{directives:[{name:"format",rawName:"v-format",value:"yyyy-MM-dd hh:mm",expression:"'yyyy-MM-dd hh:mm'"}],staticClass:"create-time"},[e._v(e._s(t.createTime))]),a("div",{staticClass:"auth",class:{active:1===t.auth}},[e._v(" "+e._s(1===t.auth?"会员":"非会员")+" ")]),a("div",{directives:[{name:"format",rawName:"v-format",value:"yyyy-MM-dd",expression:"'yyyy-MM-dd'"}],staticClass:"expire-time",class:{active:1===t.auth}},[e._v(" "+e._s(1===t.auth?t.expireTime:"0000000")+" ")]),a("div",{staticClass:"manage"},[e._v(" "+e._s(1===t.manage?"管理员":"普通用户")+" ")]),a("div",{staticClass:"playlist"},[a("span",[e._v("歌单数：")]),a("span",[e._v(e._s(t.playlist))])]),a("div",{staticClass:"channel"},[a("span",[e._v("声音作品：")]),a("span",[e._v(e._s(t.channel))])]),a("div",{staticClass:"moment"},[a("span",[e._v("动态：")]),a("span",[e._v(e._s(t.moment))])]),a("div",{staticClass:"control-btn"},[a("button",{on:{click:function(a){return e.editUser(t,s)}}},[e._v("编辑")]),a("button",{on:{click:function(a){return e.deleteUser(t,s)}}},[e._v("删除")])])])})),0),e.total>10?a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":10},on:{"current-change":e.pageChange}})],1):e._e(),a("el-drawer",{attrs:{title:"专辑信息",visible:e.drawer,"destroy-on-close":!0,"show-close":!1},on:{"update:visible":function(t){e.drawer=t}},scopedSlots:e._u([{key:"title",fn:function(){return[a("div",{staticClass:"title-control"},[a("div",{staticClass:"title"},[e._v("编辑用户信息")]),a("div",{staticClass:"define",on:{click:e.define}},[e._v("确定")])])]},proxy:!0}])},[e.drawer?a("edit-user",{ref:"editUser",attrs:{user:e.user}}):e._e()],1)],1)},i=[],n=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-header"},[a("ul",[a("li",[a("div",{staticClass:"key"},[e._v("系统用户 :")]),a("div",{staticClass:"value"},[e._v(e._s(e.userCount.total))])]),a("li",[a("div",{staticClass:"key"},[e._v("vip用户 :")]),a("div",{staticClass:"value"},[e._v(e._s(e.userCount.vip))])]),a("li",[a("div",{staticClass:"key"},[e._v("非vip用户 :")]),a("div",{staticClass:"value"},[e._v(e._s(e.userCount.noVip))])]),a("li",[a("div",{staticClass:"key"},[e._v("管理员 :")]),a("div",{staticClass:"value"},[e._v(e._s(e.userCount.manage))])])])])}),r=[],o=a("a70f"),u={name:"UserHeader",data:function(){return{userCount:{}}},created:function(){var e=this;Object(o["d"])().then((function(t){e.userCount=t}))}},l=u,c=(a("e46e"),a("2877")),d=Object(c["a"])(l,n,r,!1,null,"88110bec",null),m=d.exports,f=a("20ca"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-user"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"会员信息",prop:"vip"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.vip,callback:function(t){e.$set(e.form,"vip",t)},expression:"form.vip"}},[a("el-option",{attrs:{value:0,label:"非会员"}}),a("el-option",{attrs:{value:1,label:"会员"}})],1)],1),1===e.form.vip?a("el-form-item",{attrs:{label:"套餐类型",prop:"combo"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.combo,callback:function(t){e.$set(e.form,"combo",t)},expression:"form.combo"}},e._l(e.comboList,(function(e,t){return a("el-option",{key:e.id,attrs:{value:e.id,label:"￥"+e.price+" / "+e.name}})})),1)],1):e._e(),1===e.form.vip?a("el-form-item",{attrs:{label:"会员到期时间",prop:"expireTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择会员到期时间","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.form.expireTime,callback:function(t){e.$set(e.form,"expireTime",t)},expression:"form.expireTime"}})],1):e._e(),a("el-form-item",{attrs:{label:"用户身份",prop:"manage"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.form.manage,callback:function(t){e.$set(e.form,"manage",t)},expression:"form.manage"}},[a("el-option",{attrs:{value:1,label:"管理员"}}),a("el-option",{attrs:{value:0,label:"普通用户"}})],1)],1)],1)],1)},v=[],h=a("6be8"),b={name:"EditUser",data:function(){return{form:{name:"",expireTime:"",vip:0,manage:0,combo:""},rules:{name:[{required:!0,message:"请输用户名称",trigger:"blur"}],vip:[{required:!0,message:"请选择VIP类型",trigger:"change"}],expireTime:[{required:!0,message:"请选择过期时间",trigger:"change"}],manage:[{required:!0,message:"请选择用户身份",trigger:"change"}],combo:[{required:!0,message:"请选择套餐",trigger:"change"}]},comboList:[]}},props:{user:{type:Object,default:function(){return{}}}},created:function(){var e=this;Object(o["b"])().then((function(t){e.comboList=t})),this.form.name=this.user.userName,this.form.vip=this.user.auth,this.form.combo=this.user.cId,this.form.manage=this.user.manage,this.form.expireTime=Object(h["a"])(this.user.expireTime,"yyyy-MM-dd hh:mm:ss")},methods:{}},g=b,y=(a("1634"),Object(c["a"])(g,p,v,!1,null,"7d37f15a",null)),_=y.exports,k={name:"User",components:{EditUser:_,UserHeader:m},data:function(){return{keyword:"",isVip:-1,isManage:-1,total:0,userList:[],drawer:!1,user:{}}},created:function(){var e=this;Object(o["e"])(this.isVip,this.isManage,this.keyword,"0","10").then((function(t){e.total=t.count,e.userList=t.user}))},methods:{pageChange:function(e){var t=this;Object(o["e"])(this.isVip,this.isManage,this.keyword,"".concat(10*(e-1)),"10").then((function(e){t.total=e.count,t.userList=e.user}))},inpSearch:Object(f["a"])((function(){var e=this;Object(o["e"])(this.isVip,this.isManage,this.keyword,"0","10").then((function(t){e.total=t.count,e.userList=t.user}))}),1e3,!1),vipChange:function(){var e=this;Object(o["e"])(this.isVip,this.isManage,this.keyword,"0","10").then((function(t){e.total=t.count,e.userList=t.user}))},manageChange:function(){var e=this;Object(o["e"])(this.isVip,this.isManage,this.keyword,"0","10").then((function(t){e.total=t.count,e.userList=t.user}))},editUser:function(e,t){this.user=e,this.drawer=!0},deleteUser:function(e,t){var a=this;this.$confirm("确认删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["a"])(e.userId).then((function(e){Object(o["e"])(a.isVip,a.isManage,a.keyword,"0","10").then((function(e){a.total=e.count,a.userList=e.user})),a.$message({message:"删除成功",type:"success"})}))})).catch((function(e){}))},define:function(){var e=this;this.$refs.editUser.$refs.form&&this.$refs.editUser.$refs.form.validate((function(t){if(t){var a=e.$refs.editUser.form,s=a.vip,i=a.name,n=a.manage,r=a.expireTime,u=a.combo;Object(o["f"])(e.user.userId,s,i,n,r,u).then((function(t){e.$message({message:"更新成功",duration:1500,type:"success"}),e.drawer=!1,Object(o["e"])(e.isVip,e.isManage,e.keyword,"0","10").then((function(t){e.total=t.count,e.userList=t.user}))}))}}))}}},C=k,w=(a("231d"),a("50d3"),Object(c["a"])(C,s,i,!1,null,"406d9c58",null));t["default"]=w.exports},a70f:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"f",(function(){return u})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c}));var s=a("1bab"),i=a("4360");function n(){return Object(s["a"])({url:"/user/count",headers:{authorization:i["a"].state.userMsg.token}})}function r(e,t,a,n,r){return Object(s["a"])({url:"/user/list",method:"post",data:{vip:e,manage:t,keyword:a,offset:n,limit:r},headers:{authorization:i["a"].state.userMsg.token}})}function o(){return Object(s["a"])({url:"/combo/all",method:"get",headers:{authorization:i["a"].state.userMsg.token}})}function u(e,t,a,n,r,o){return Object(s["a"])({url:"/user/update",method:"post",data:{userId:e,vip:t,name:a,manage:n,expireTime:r,combo:o},headers:{authorization:i["a"].state.userMsg.token}})}function l(){return Object(s["a"])({url:"/user/system/data",method:"post",headers:{authorization:i["a"].state.userMsg.token}})}function c(e){return Object(s["a"])({url:"/user/delete",method:"post",data:{userId:e},headers:{authorization:i["a"].state.userMsg.token}})}},c4e2:function(e,t,a){},e46e:function(e,t,a){"use strict";a("c4e2")},ee26:function(e,t,a){}}]);
//# sourceMappingURL=chunk-2d783e4a.0222a8e5.js.map