(this["webpackJsonpgb-music-react"]=this["webpackJsonpgb-music-react"]||[]).push([[33],{106:function(n,t,e){"use strict";e.d(t,"b",(function(){return l})),e.d(t,"a",(function(){return f})),e.d(t,"c",(function(){return g})),e.d(t,"d",(function(){return p}));var r=e(174),i=e.n(r),a=e(175),o=e(499),u=e(115),c=e(108),s=e(45);function l(n){return{type:"changeUserMsg",userMsg:n}}function d(n){return{type:"changeLoginType",loginType:n}}function f(){return function(n){Object(c.f)().then((function(t){var e=t.love,r=t.follow;e||(t.love=[]),r||(t.follow=[]),window.localStorage.setItem("userDetail",JSON.stringify(t)),n({type:"changeUserDetail",userDetail:t})}))}}function g(n,t,e){return function(){var r=Object(a.a)(i.a.mark((function r(a){var g,p;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(u.a)(n,t);case 3:if(!(g=r.sent)){r.next=19;break}return p=g.token,r.next=8,Object(c.l)(p);case 8:return 1*r.sent.code===200&&(a(Object(s.a)("\u60a8\u7684VIP\u5df2\u7ecf\u8fc7\u671f\uff0c\u5f00\u901aVIP\u540e\u7545\u60f3",3500)),g.auth=0,delete g.vip),r.next=12,a(l(g));case 12:return r.next=14,a(d(1));case 14:return window.localStorage.setItem("userMsg",JSON.stringify(g)),window.localStorage.setItem("loginType","1"),r.next=18,a(f());case 18:e.history.push({pathname:"/Home"});case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(0),console.log(r.t0),o.b.warning({content:"\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef",style:{fontSize:"20px",marginTop:"5vh"}});case 25:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(n){return r.apply(this,arguments)}}()}function p(){return function(n){window.localStorage.clear(),n(d(0)),n(l({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),n({type:"changeUserDetail",userDetail:{userId:"",userName:"",avatarUrl:"",subscriber:[],thumb:[],follow:[{userId:""}],love:[{songId:""}]}})}}},108:function(n,t,e){"use strict";e.d(t,"k",(function(){return a})),e.d(t,"g",(function(){return o})),e.d(t,"a",(function(){return u})),e.d(t,"i",(function(){return c})),e.d(t,"f",(function(){return s})),e.d(t,"m",(function(){return l})),e.d(t,"b",(function(){return d})),e.d(t,"e",(function(){return f})),e.d(t,"j",(function(){return g})),e.d(t,"l",(function(){return p})),e.d(t,"h",(function(){return h})),e.d(t,"d",(function(){return m})),e.d(t,"c",(function(){return b}));var r=e(97),i=e(22);function a(n){return Object(r.a)({url:"/user/favorite",method:"post",data:{id:n},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function o(n,t){return Object(r.a)({url:"/user/favorite",params:{offset:n,limit:t},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(n){return Object(r.a)({url:"/user/favorite/cancel",method:"post",data:{songId:n},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function c(n,t,e){return Object(r.a)({url:"/sub/user/".concat(n),params:{offset:t,limit:e},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function s(){return Object(r.a)({url:"/user/detail",headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function l(n){return Object(r.a)({url:"/user/upload/avatar",method:"post",headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-Type":"multipart/form-data"},data:n})}function d(n){return Object(r.a)({url:"/user/other/detail",method:"post",data:{userId:n},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function f(n,t,e){return Object(r.a)({url:"/user/channel",method:"post",data:{userId:n,offset:t,limit:e},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function g(n,t,e){return Object(r.a)({url:"/sub/user/playlist",method:"post",params:{offset:t,limit:e},data:{userId:n}})}function p(n){return Object(r.a)({url:"/user/expire",method:"post",headers:{authorization:n}})}function h(){return Object(r.a)({url:"/user/data/moment",method:"post",headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function m(n,t){return Object(r.a)({url:"/user/moment",method:"post",data:{offset:n,limit:t},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function b(n){return Object(r.a)({url:"/user/simple",params:{userId:n},headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},115:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return a}));var r=e(97);function i(n,t){return Object(r.a)({url:"/login",method:"post",data:{userName:n,password:t}})}function a(n,t){return Object(r.a)({url:"/register",method:"post",data:{userName:n,password:t}})}},122:function(n,t,e){"use strict";function r(n,t){var e=new Date(n);/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var a in r)if(new RegExp("(".concat(a,")")).test(t)){var o=r[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?o:i(o))}return t||""}function i(n){return("00"+n).substr(n.length)}e.d(t,"a",(function(){return r}))},244:function(n,t,e){"use strict";e.d(t,"g",(function(){return s})),e.d(t,"e",(function(){return l})),e.d(t,"c",(function(){return f})),e.d(t,"a",(function(){return g})),e.d(t,"d",(function(){return h})),e.d(t,"f",(function(){return m})),e.d(t,"b",(function(){return b}));var r=e(377),i=e(249),a=e(252),o=e(258),u=e(259),c=e(253);function s(n){return{type:"changeSongURL",songUrl:n}}function l(n){return document.title="".concat(n.name," - ").concat(n.artist?n.artist.name:n.channel.name," - gb-music"),{type:"changeSongDetail",songDetail:n}}function d(n){return{type:"changeLyric",lyric:n}}function f(n){return{type:"changeLyricLine",lyricLine:n}}function g(n){return{type:"changeCurrentLyricIndex",currentLyricIndex:n}}function p(n){return{type:"changeCurrentIndex",currentIndex:n}}function h(n){return{type:"changePlayMode",playMode:n}}function m(n){return function(t,e){var a=e().getIn(["songReducer","song"]).playlist,u=a.findIndex((function(t,e){return t.id===n}));t(Object(o.a)(0)),-1===u&&(Object(i.e)(n).then((function(e){t(l(e)),t(j(n)),t(v(n));var i=Object(r.a)(a);i.push(e),t({type:"changePlaylist",playlist:i}),t(p(i.length-1))})),Object(i.a)(n)),-1!==u&&(t(p(u)),t(l(a[u])),t(j(n)),t(v(n)),Object(i.a)(n))}}function b(n){return function(t,e){var r=e().getIn(["songReducer","song"]).playMode,i=e().getIn(["songReducer","song"]).playlist,o=e().getIn(["songReducer","song"]).currentIndex;switch(r){case 1:if(1!==i.length){for(var u=Object(a.a)(0,i.length-1);u===o;)u=Object(a.a)(0,i.length-1);o=u}else 1!==i.length&&0!==i.length||(o=0);break;default:(o+=n)<0&&(o=i.length-1),o>i.length-1&&(o=0)}t(p(o)),t(l(i[o])),t(j(i[o].id))}}function j(n){return function(t){Object(i.f)(n).then((function(n){var e=n.mp3Url,r=Object(c.a)(e);t(s(r))}))}}function v(n){return function(t){Object(i.c)(n).then((function(n){n.lyric?t(d(function(n){var t,e=[],r=/\[(\d{2}):(\d{2})\.(\d{2,3})\]/,i=n.split("\n"),a=Object(u.a)(i);try{for(a.s();!(t=a.n()).done;){var o=t.value;if(o){var c=r.exec(o);if(!c)continue;var s={duration:60*c[1]*1e3+1e3*c[2]+(3===c[3].length?1*c[3]:10*c[3]),content:o.replace(r,"").trim()};e.push(s)}}}catch(l){a.e(l)}finally{a.f()}return e}(n.lyric))):t(d("\u6682\u65e0\u6b4c\u8bcd"))}))}}},249:function(n,t,e){"use strict";e.d(t,"d",(function(){return c})),e.d(t,"f",(function(){return s})),e.d(t,"e",(function(){return l})),e.d(t,"c",(function(){return d})),e.d(t,"a",(function(){return f})),e.d(t,"b",(function(){return g}));var r=e(97),i=e(22),a=e(257),o=e.n(a),u=e(26);function c(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return Object(r.a)({url:"/song/recommend",params:{offset:n,limit:t}})}function s(n){return Object(r.a)({url:"/song/url",params:{id:n}})}function l(n){return Object(r.a)({url:"/song/detail",params:{id:n}})}function d(n){return Object(r.a)({url:"/song/lyric",params:{id:n}})}function f(n){return Object(r.a)({url:"/song/playCount",method:"post",data:{id:n}})}function g(n,t){fetch("".concat(u.a,"/song/download"),{method:"post",headers:{authorization:i.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-Type":"application/json"},body:JSON.stringify({id:n})}).then((function(n){var e=o.a.createWriteStream(t+".mp3",{size:n.headers.get("content-length")}),r=n.body;if(window.WritableStream&&r.pipeTo)return r.pipeTo(e).then((function(){}));window.writer=e.getWriter();var i=n.body.getReader();!function n(){return i.read().then((function(t){return t.done?window.writer.close():window.writer.write(t.value).then(n)}))}()}))}},252:function(n,t,e){"use strict";e.d(t,"a",(function(){return r}));var r=function(n,t){return Math.floor(Math.random()*(t-n+1))+n}},253:function(n,t,e){"use strict";e.d(t,"a",(function(){return a}));var r=e(260),i=e.n(r);function a(n){var t=i.a.verify(n,"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVngqLlcT4xs9q18KCEWGaNYIa\nEMwSIus02VG3XVt8IGwT5Ws8Z1qCULz7jxERDKgSyfUM0EMOQ2KH/Z/ZhhZAld1r\nDCjxhiWLwXx5qYWJo9U862aYMQUjb3J5iqf2Wg+OuHPYkZ9oUvQl01kMRTkEkprf\nkNSJkagkgGMGph5OywIDAQAB\n-----END PUBLIC KEY-----",{algorithms:["RS256"]});return t&&t.url||t&&t.mp3Url?t.url||t.mp3Url:""}},258:function(n,t,e){"use strict";function r(n){return{type:"changePlayType",playType:n}}e.d(t,"a",(function(){return r}))},261:function(n,t){},262:function(n,t){},263:function(n,t){},264:function(n,t){},265:function(n,t){},266:function(n,t){},267:function(n,t){},268:function(n,t){},269:function(n,t){},270:function(n,t){},385:function(n,t,e){"use strict";var r,i=e(0),a=e(11),o=e(12).a.div(r||(r=Object(a.a)(["\n  .vip-mv {\n    display: flex;\n    align-items: center;\n    .vip,\n    .mv {\n      font-size: 12px;\n      padding: 0 4px 1px 4px;\n      border-radius: 4px;\n      line-height: 13px;\n      margin: 0 2px 0 0;\n      transform: scale(0.85);\n    }\n    .vip {\n      border: 2px solid #fa8153;\n      color: #fa8153;\n      font-weight: 600;\n    }\n    .mv {\n      border: 2px solid #ec4747;\n      color: #ec4747;\n      font-weight: bold;\n      cursor: pointer;\n    }\n  }\n"]))),u=e(3),c=e(2),s=function(n){var t=n.isShowMv,e=n.isShowVip,r=n.onClick,i=function(n){n.stopPropagation(),r()};return Object(c.jsx)(o,{children:Object(c.jsxs)("ul",{className:"vip-mv",children:[e&&Object(c.jsx)("li",{className:"vip",onClick:function(n){return n.stopPropagation()},children:"VIP"}),t&&Object(c.jsx)("li",{className:"mv",onClick:function(n){return i(n)},children:"MV"})]})})};t.a=Object(u.h)(Object(i.memo)(s))},548:function(n,t,e){"use strict";e.r(t);var r,i=e(0),a=e(10),o=e(11),u=e(12).a.ul(r||(r=Object(o.a)(["\n  & > li {\n    display: flex;\n    align-items: center;\n    padding: 10px 20px;\n    &:nth-child(odd) {\n      background-color: #f9f9f9;\n    }\n    &:hover {\n      background-color: #f0f1f2;\n    }\n    .index {\n      color: #cfd2d9;\n      font-size: 13px;\n      padding: 0 15px 0 0;\n    }\n    .name {\n      width: 30%;\n      color: #0086b3;\n      display: flex;\n      align-items: center;\n      cursor: pointer;\n      & > span {\n        font-size: 13px;\n        max-width: 155px;\n        display: inline-block;\n        margin: 0 5px 0 0;\n      }\n    }\n    .album-name,\n    .artist-name {\n      color: #656565;\n      font-size: 13px;\n      width: 20%;\n      cursor: pointer;\n    }\n    .dt {\n      color: #9b9b9b;\n      font-size: 12px;\n    }\n  }\n"]))),c=e(122),s=e(244),l=e(19),d=e(385),f=e(2),g=function(n){var t=Object(a.c)((function(n){return n.getIn(["searchReducer","searchResult"])})).song,e=Object(a.b)();return Object(f.jsxs)(u,{children:[t&&0!==t.length&&t.map((function(t,r){return Object(f.jsxs)("li",{children:[Object(f.jsx)("div",{className:"index",children:(r+1).toString().padStart(2,"0")}),Object(f.jsxs)("div",{className:"name text-nowrap",onClick:function(n){return function(n,t){e(Object(s.f)(n.id))}(t)},children:[Object(f.jsx)("span",{className:"text-nowrap",children:t.name}),Object(f.jsx)(d.a,{isShowVip:1===t.vip,isShowMv:t.video,onClick:function(){return function(t){n.history.push({pathname:"/Home/videoDetail",state:{id:t.video.id}})}(t)}})]}),Object(f.jsx)("div",{className:"artist-name",onClick:function(e){return function(t,e){n.history.push({pathname:"/Home/artistDetail",state:{id:t.artist.id}})}(t)},children:t.artist.name}),Object(f.jsx)("div",{className:"album-name",onClick:function(e){return function(t,e){n.history.push({pathname:"/Home/albumDetail",state:{id:t.album.id}})}(t)},children:t.album.name}),Object(f.jsx)("div",{className:"dt",children:Object(c.a)(t.duration,"mm:ss")})]},t.id)})),t&&0===t.length&&Object(f.jsx)("div",{style:{height:"350px",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(f.jsx)(l.a,{image:l.a.PRESENTED_IMAGE_SIMPLE,description:"\u6682\u65e0\u6b4c\u66f2"})})]})};t.default=Object(i.memo)(g)},97:function(n,t,e){"use strict";var r=e(173),i=e.n(r),a=e(26),o=e(22),u=e(106),c=e(9);t.a=function(n){var t=i.a.create({baseURL:a.a,timeout:15e3});return t.interceptors.request.use((function(n){return n}),(function(n){return console.log(n),n})),t.interceptors.response.use((function(n){return n.data}),(function(n){if(n.response){var t=n.response,e=t.status,r=t.data;if(1*e!==403||"\u8bf7\u767b\u5f55"!==r.message)throw n;o.a.dispatch(Object(u.d)()),o.a.dispatch(Object(u.b)({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),Object(c.a)().push({pathname:"/Login"})}})),t.request(n)}}}]);
//# sourceMappingURL=33.e222caa7.chunk.js.map