(this["webpackJsonpgb-music-react"]=this["webpackJsonpgb-music-react"]||[]).push([[44],{106:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return p}));var r=n(174),a=n.n(r),o=n(175),i=n(499),u=n(115),c=n(108),s=n(45);function d(e){return{type:"changeUserMsg",userMsg:e}}function l(e){return{type:"changeLoginType",loginType:e}}function f(){return function(e){Object(c.f)().then((function(t){var n=t.love,r=t.follow;n||(t.love=[]),r||(t.follow=[]),window.localStorage.setItem("userDetail",JSON.stringify(t)),e({type:"changeUserDetail",userDetail:t})}))}}function g(e,t,n){return function(){var r=Object(o.a)(a.a.mark((function r(o){var g,p;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(u.a)(e,t);case 3:if(!(g=r.sent)){r.next=19;break}return p=g.token,r.next=8,Object(c.l)(p);case 8:return 1*r.sent.code===200&&(o(Object(s.a)("\u60a8\u7684VIP\u5df2\u7ecf\u8fc7\u671f\uff0c\u5f00\u901aVIP\u540e\u7545\u60f3",3500)),g.auth=0,delete g.vip),r.next=12,o(d(g));case 12:return r.next=14,o(l(1));case 14:return window.localStorage.setItem("userMsg",JSON.stringify(g)),window.localStorage.setItem("loginType","1"),r.next=18,o(f());case 18:n.history.push({pathname:"/Home"});case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(0),console.log(r.t0),i.b.warning({content:"\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef",style:{fontSize:"20px",marginTop:"5vh"}});case 25:case"end":return r.stop()}}),r,null,[[0,21]])})));return function(e){return r.apply(this,arguments)}}()}function p(){return function(e){window.localStorage.clear(),e(l(0)),e(d({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),e({type:"changeUserDetail",userDetail:{userId:"",userName:"",avatarUrl:"",subscriber:[],thumb:[],follow:[{userId:""}],love:[{songId:""}]}})}}},108:function(e,t,n){"use strict";n.d(t,"k",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"a",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"l",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return m}));var r=n(97),a=n(22);function o(e){return Object(r.a)({url:"/user/favorite",method:"post",data:{id:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function i(e,t){return Object(r.a)({url:"/user/favorite",params:{offset:e,limit:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(e){return Object(r.a)({url:"/user/favorite/cancel",method:"post",data:{songId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function c(e,t,n){return Object(r.a)({url:"/sub/user/".concat(e),params:{offset:t,limit:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function s(){return Object(r.a)({url:"/user/detail",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function d(e){return Object(r.a)({url:"/user/upload/avatar",method:"post",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-Type":"multipart/form-data"},data:e})}function l(e){return Object(r.a)({url:"/user/other/detail",method:"post",data:{userId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function f(e,t,n){return Object(r.a)({url:"/user/channel",method:"post",data:{userId:e,offset:t,limit:n},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function g(e,t,n){return Object(r.a)({url:"/sub/user/playlist",method:"post",params:{offset:t,limit:n},data:{userId:e}})}function p(e){return Object(r.a)({url:"/user/expire",method:"post",headers:{authorization:e}})}function b(){return Object(r.a)({url:"/user/data/moment",method:"post",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function h(e,t){return Object(r.a)({url:"/user/moment",method:"post",data:{offset:e,limit:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function m(e){return Object(r.a)({url:"/user/simple",params:{userId:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},115:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(97);function a(e,t){return Object(r.a)({url:"/login",method:"post",data:{userName:e,password:t}})}function o(e,t){return Object(r.a)({url:"/register",method:"post",data:{userName:e,password:t}})}},143:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},239:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return p})),n.d(t,"j",(function(){return b}));var r=n(143),a=n(97),o=n(22);function i(e,t,n,i){return Object(a.a)({url:"/message/".concat(e),method:"post",data:Object(r.a)({content:t},n,i),headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function u(){return Object(a.a)({url:"/message",headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function c(e){return Object(a.a)({url:"/message/read",method:"post",data:{id:e},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function s(e,t){return Object(a.a)({url:"/message/detail/video",method:"post",data:{offset:e,limit:t},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function d(e,t){return Object(a.a)({url:"/message/detail/comment",method:"post",data:{offset:e,limit:t},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function l(e,t){return Object(a.a)({url:"/message/detail/album",method:"post",data:{offset:e,limit:t},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function f(e,t){return Object(a.a)({url:"/message/detail/playlist",method:"post",data:{offset:e,limit:t},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function g(e,t){return Object(a.a)({url:"/message/detail/channel",method:"post",data:{offset:e,limit:t},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function p(e){return Object(a.a)({url:"/message/delete",method:"post",data:{id:e},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function b(e){return Object(a.a)({url:"/message/read/single",method:"post",data:{id:e},headers:{authorization:o.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},386:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"b",(function(){return p})),n.d(t,"h",(function(){return b}));var r=n(97),a=n(22);function o(e){return Object(r.a)({url:"/video/cate/all",params:{type:e}})}function i(e,t,n,a){return Object(r.a)({url:"/video/cate/detail",params:{cateId:e,type:t,offset:n,limit:a}})}function u(e){return Object(r.a)({url:"/video/url",params:{vid:e}})}function c(e){return Object(r.a)({url:"/video/detail",params:{id:e}})}function s(e){return Object(r.a)({url:"/video/similar",params:{id:e}})}function d(e){return Object(r.a)({url:"/video/playCount",method:"post",data:{id:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function l(e,t,n,o,i){return Object(r.a)({url:"/video",method:"post",data:{name:e,desc:t,type:n,cateId:o,songId:i},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function f(e,t){return Object(r.a)({url:"/video/upload",method:"post",data:e,params:{vid:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-type":"multipart/form-data"}})}function g(e,t){return Object(r.a)({url:"/video/cover/upload",method:"post",data:e,params:{id:t},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token,"Content-type":"multipart/form-data"}})}function p(e){return Object(r.a)({url:"/video/delete",method:"post",data:{id:e},headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}function b(){return Object(r.a)({url:"/video/recommend",headers:{authorization:a.a.getState().getIn(["loginReducer","login","userMsg"]).token}})}},400:function(e,t,n){"use strict";function r(e){return new Promise((function(t,n){var r=document.createElement("canvas"),a=r.getContext("2d"),o=document.createElement("video");o.setAttribute("controls","controls"),o.src=e,o.currentTime=1,o.oncanplay=function(){r.height=o.videoHeight,r.width=o.videoWidth,a.drawImage(o,0,0,o.videoWidth,o.videoHeight);var e=r.toDataURL("image/png");t(e)}}))}function a(e){var t=URL.createObjectURL(e),n=document.createElement("video");return n.setAttribute("src",t),new Promise((function(e,t){n.oncanplay=function(){e(1e3*n.duration)}}))}function o(e){var t=URL.createObjectURL(e),n=document.createElement("audio");return n.setAttribute("src",t),new Promise((function(e,t){n.oncanplay=function(){e(1e3*n.duration)}}))}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}))},559:function(e,t,n){"use strict";n.r(t);var r,a=n(40),o=n(0),i=n(11),u=n(12).a.div(r||(r=Object(i.a)(["\n  position: relative;\n  textarea {\n    resize: none;\n  }\n  .upload-outer {\n    width: 500px;\n    height: 300px;\n    border: 1px dotted #cccccc;\n    margin: 30px auto;\n    border-radius: 8px;\n    text-align: center;\n    padding-top: 20px;\n    i.iconfont {\n      font-size: 50px;\n      color: #ff3a3a;\n    }\n    .upload-btn {\n      border-bottom: 1px solid #ff3a3a;\n      display: inline-block;\n      margin: 30px 0 0 0;\n      color: #5091cb;\n      cursor: pointer;\n      position: relative;\n      overflow: hidden;\n    }\n  }\n  .upload {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);\n    background-color: #fff;\n    padding: 30px 50px;\n    border-radius: 8px;\n    .name,\n    .desc {\n      margin: 0 0 20px 0;\n      display: flex;\n      span {\n        margin: 0 5px 0 0;\n      }\n    }\n    textarea {\n      border: 1px solid #cbc9c0;\n    }\n    .preview {\n      display: flex;\n      height: 100px;\n      .img-preview,\n      .video-preview {\n        flex: 1;\n        background-color: #f2f2f2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        position: relative;\n        overflow: hidden;\n        i.iconfont {\n          font-size: 32px;\n          color: #ff3a3a;\n        }\n        input {\n          position: absolute;\n          height: 100%;\n          opacity: 0;\n          cursor: pointer;\n        }\n        img {\n          height: 100%;\n        }\n      }\n      .img-preview {\n        border-right: 1px dotted #cbc9c0;\n      }\n    }\n    .cate-list {\n      display: flex;\n      width: 400px;\n      flex-wrap: wrap;\n      margin: 10px 0 0 0;\n      & > li {\n        background-color: #f7b3b3;\n        color: #fff;\n        margin: 0 15px 15px 0;\n        font-size: 13px;\n        padding: 4px 10px;\n        border-radius: 4px;\n        cursor: pointer;\n        &:hover {\n          background-color: #f27a7a;\n        }\n        &.active {\n          background-color: #f27a7a;\n        }\n      }\n    }\n    .control-btn {\n      display: flex;\n      justify-content: flex-end;\n      button {\n        font-size: 13px;\n        padding: 4px 15px;\n        margin: 0 0 0 25px;\n        cursor: pointer;\n        &:nth-child(1) {\n          background-color: #f27a7a;\n          color: #fff;\n        }\n        &:nth-child(2) {\n          background-color: #efefef;\n          color: #656565;\n        }\n      }\n    }\n  }\n"]))),c=n(386),s=n(400),d=n(10),l=n(45),f=n(239),g=n(2),p=function(){var e=Object(o.useState)([]),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)(""),p=Object(a.a)(i,2),b=p[0],h=p[1],m=Object(o.useState)(""),j=Object(a.a)(m,2),O=j[0],v=j[1],x=Object(o.useState)(""),k=Object(a.a)(x,2),I=k[0],S=k[1],w=Object(o.useState)(),R=Object(a.a)(w,2),y=R[0],z=R[1],M=Object(o.useState)(),N=Object(a.a)(M,2),T=N[0],U=N[1],C=Object(o.useState)(""),L=Object(a.a)(C,2),D=L[0],P=L[1],E=Object(o.useState)(0),J=Object(a.a)(E,2),A=J[0],H=J[1],q=Object(o.useState)(!1),F=Object(a.a)(q,2),V=F[0],W=F[1],B=Object(o.useState)(""),G=Object(a.a)(B,2),K=G[0],Q=G[1],X=Object(o.useState)(""),Y=Object(a.a)(X,2),Z=Y[0],$=Y[1],_=Object(o.useState)(!1),ee=Object(a.a)(_,2),te=ee[0],ne=ee[1],re=Object(o.useState)(!1),ae=Object(a.a)(re,2),oe=ae[0],ie=ae[1],ue=Object(d.b)();Object(o.useEffect)((function(){Object(c.e)(0).then((function(e){r(e),h(e[0].id)}))}),[]);return Object(g.jsxs)(u,{children:[Object(g.jsxs)("div",{className:"upload-outer",children:[Object(g.jsx)("i",{className:"iconfont icon-upload",children:" "}),Object(g.jsx)("div",{className:"tip",children:"\u4e30\u5bcc\u7684\u97f3\u4e50\u7075\u611f/\u521b\u4f5c\u788e\u7247\u7b49"}),Object(g.jsx)("span",{className:"upload-btn",onClick:function(e){W(!0)},children:"\u70b9\u51fb\u4e0a\u4f20"})]}),V&&Object(g.jsxs)("div",{className:"upload",children:[Object(g.jsxs)("div",{className:"name",children:[Object(g.jsx)("span",{children:"\u540d\u79f0:"}),Object(g.jsx)("textarea",{rows:2,cols:50,onChange:function(e){return function(e){v(e.currentTarget.value)}(e)},value:O,children:" "})]}),Object(g.jsxs)("div",{className:"desc",children:[Object(g.jsx)("span",{children:"\u7b80\u4ecb:"}),Object(g.jsx)("textarea",{rows:7,cols:50,value:I,onChange:function(e){return function(e){S(e.currentTarget.value)}(e)},children:" "})]}),Object(g.jsxs)("div",{className:"preview",children:[Object(g.jsxs)("div",{className:"img-preview",children:[!te&&Object(g.jsx)("input",{type:"file",title:"\u9009\u62e9\u5c01\u9762",onChange:function(e){return function(e){if(e.currentTarget.files){var t=e.currentTarget.files[0];z(t);var n=URL.createObjectURL(t);Q(n),ne(!0)}}(e)}}),!te&&Object(g.jsx)("i",{className:"iconfont icon-tupian",children:" "}),te&&Object(g.jsx)("img",{src:K,alt:"\u5c01\u9762\u9884\u89c8"})]}),Object(g.jsxs)("div",{className:"video-preview",children:[!oe&&Object(g.jsx)("input",{type:"file",title:"\u9009\u62e9\u89c6\u9891",onChange:function(e){return function(e){if(e.currentTarget.files){var t=e.currentTarget.files[0];U(t);var n=URL.createObjectURL(t);Object(s.b)(n).then((function(e){$(e),ie(!0),Object(s.c)(t).then((function(e){P(e)}))}))}}(e)}}),!oe&&Object(g.jsx)("i",{className:"iconfont icon-video",children:" "}),oe&&Object(g.jsx)("img",{src:Z,alt:"\u89c6\u9891\u9884\u89c8"})]})]}),Object(g.jsx)("div",{className:"cate-title",children:"\u5206\u7c7b:"}),Object(g.jsx)("ul",{className:"cate-list",children:0!==n.length&&n.map((function(e,t){return Object(g.jsx)("li",{className:A===t?"active":"",onClick:function(n){return function(e,t){H(t),h(e.id)}(e,t)},children:e.name},e.id)}))}),Object(g.jsxs)("div",{className:"control-btn",children:[Object(g.jsx)("button",{className:"define",onClick:function(e){0===O.trim().length?ue(Object(l.a)("\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a",1500)):0===I.trim().length?ue(Object(l.a)("\u7b80\u4ecb\u4e0d\u80fd\u4e3a\u7a7a",1500)):T?y?Object(c.a)(O,I,0,b,void 0).then((function(e){var t=e.id;if(t){var n=new FormData;n.append("video",T),n.append("dt",D),Object(c.k)(n,t).then((function(e){}));var r=new FormData;r.append("cover",y),Object(c.j)(r,t).then((function(e){W(!1),P(""),z(void 0),v(""),S(""),Q(""),$("")})),Object(f.h)("/video","\u53d1\u5e03\u4e86","vId",t)}})):ue(Object(l.a)("\u8bf7\u9009\u62e9\u5c01\u9762",1500)):ue(Object(l.a)("\u8bf7\u9009\u62e9\u89c6\u9891",1500))},children:"\u786e\u5b9a"}),Object(g.jsx)("button",{className:"cancel",onClick:function(e){return W(!1),ie(!1),ne(!1),$(""),Q(""),v(""),void S("")},children:"\u53d6\u6d88"})]})]})]})};t.default=Object(o.memo)(p)},97:function(e,t,n){"use strict";var r=n(173),a=n.n(r),o=n(26),i=n(22),u=n(106),c=n(9);t.a=function(e){var t=a.a.create({baseURL:o.a,timeout:15e3});return t.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),e})),t.interceptors.response.use((function(e){return e.data}),(function(e){if(e.response){var t=e.response,n=t.status,r=t.data;if(1*n!==403||"\u8bf7\u767b\u5f55"!==r.message)throw e;i.a.dispatch(Object(u.d)()),i.a.dispatch(Object(u.b)({token:"",userName:"",userId:"",avatarUrl:"",createTime:"",updateTime:"",manage:-1,auth:-1})),Object(c.a)().push({pathname:"/Login"})}})),t.request(e)}}}]);
//# sourceMappingURL=44.11896e62.chunk.js.map