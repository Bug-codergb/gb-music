{"version":3,"sources":["views/Login/store/actionCreators.tsx","network/user/index.ts","network/login/index.tsx","utils/format.ts","../node_modules/@ant-design/icons-svg/es/asn/CheckOutlined.js","../node_modules/@ant-design/icons/es/icons/CheckOutlined.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","network/vip/index.ts","network/pay/index.ts","views/success/style.tsx","views/success/index.tsx","utils/parseURL.ts","network/request.tsx"],"names":["changeUserMsg","res","type","userMsg","changeLoginType","loginType","changeUserDetailAction","dispatch","getUserDetail","then","data","love","follow","window","localStorage","setItem","JSON","stringify","userDetail","loginAction","userName","password","props","a","login","token","updateUserExpire","code","changeShow","auth","vip","history","push","pathname","console","log","message","warning","content","style","fontSize","marginTop","logoutAction","clear","userId","avatarUrl","createTime","updateTime","manage","subscriber","thumb","songId","setUserFavorite","id","request","url","method","headers","authorization","store","getState","getIn","getUserFavorite","offset","limit","params","cancelFavorite","getUserSub","uploadAvatar","formData","getOtherUserDetail","getUserChannel","getUserSubPlaylist","getUserMomentData","getUserAllMoment","getSimpleUserInfo","register","formatTime","dateS","fmt","date","Date","test","replace","RegExp","$1","getFullYear","substr","length","o","getMonth","getDate","getHours","getMinutes","getSeconds","k","str","padLeftZero","CheckOutlined","ref","React","AntdIcon","_objectSpread","icon","CheckOutlinedSvg","displayName","_createForOfIteratorHelper","allowArrayLike","it","Symbol","iterator","Array","isArray","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","getAllCombo","joinVIP","cId","name","orderId","getVipMessage","getVipHistory","deleteVIPHistory","payMoney","price","comboId","queryOrderAlipay","SuccessPageWrapper","styled","div","SuccessPage","useState","setParams","tmpParams","setTmpParams","useSelector","state","useDispatch","useEffect","includes","paramsArr","substring","lastIndexOf","split","param","toString","parseURL","location","href","out_trade_no","expireTime","getTime","parseInt","className","onClick","Object","keys","total_amount","withRouter","memo","config","instance","axios","create","baseURL","HOST_NAME","timeout","interceptors","use","response","status","createBrowserHistory"],"mappings":"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","file":"static/js/42.e494c17e.chunk.js","sourcesContent":["import { message } from 'antd';\r\nimport { login } from '../../../network/login';\r\nimport { RouteComponentProps } from 'react-router-dom';\r\nimport { getUserDetail, updateUserExpire } from '../../../network/user';\r\nimport { changeShow } from '../../../components/common/toast/store/actionCreators';\r\nimport { ILoginUserAction } from './type';\r\nimport { IUserDetail, IUserMsg } from '../../../constant/store/login';\r\n\r\nexport function changeUserMsg(res: IUserMsg): ILoginUserAction {\r\n  return {\r\n    type: 'changeUserMsg',\r\n    userMsg: res\r\n  };\r\n}\r\nfunction changeLoginType(res: number): ILoginUserAction {\r\n  return {\r\n    type: 'changeLoginType',\r\n    loginType: res\r\n  };\r\n}\r\nfunction changeUserDetail(res: IUserDetail): ILoginUserAction {\r\n  return {\r\n    type: 'changeUserDetail',\r\n    userDetail: res\r\n  };\r\n}\r\nfunction deleteUserDetail(): ILoginUserAction {\r\n  return {\r\n    type: 'changeUserDetail',\r\n    userDetail: {\r\n      userId: '',\r\n      userName: '',\r\n      avatarUrl: '',\r\n      subscriber: [],\r\n      thumb: [],\r\n      follow: [{ userId: '' }],\r\n      love: [{ songId: '' }]\r\n    }\r\n  };\r\n}\r\nexport function changeUserDetailAction() {\r\n  return (dispatch: any) => {\r\n    getUserDetail().then((data: any) => {\r\n      const { love, follow } = data;\r\n      if (!love) {\r\n        data.love = [];\r\n      }\r\n      if (!follow) {\r\n        data.follow = [];\r\n      }\r\n      window.localStorage.setItem('userDetail', JSON.stringify(data));\r\n      dispatch(changeUserDetail(data));\r\n    });\r\n  };\r\n}\r\n\r\nexport function loginAction(userName: string, password: string, props: RouteComponentProps) {\r\n  return async (dispatch: any) => {\r\n    try {\r\n      const data: any = await login(userName, password);\r\n      if (data) {\r\n        const { token } = data;\r\n        const res: any = await updateUserExpire(token);\r\n        if (res.code * 1 === 200) {\r\n          dispatch(changeShow('您的VIP已经过期，开通VIP后畅想', 3500));\r\n          data.auth = 0;\r\n          delete data.vip;\r\n        }\r\n        await dispatch(changeUserMsg(data));\r\n        await dispatch(changeLoginType(1));\r\n        window.localStorage.setItem('userMsg', JSON.stringify(data));\r\n        window.localStorage.setItem('loginType', '1');\r\n        await dispatch(changeUserDetailAction());\r\n        props.history.push({\r\n          pathname: '/Home'\r\n        });\r\n      }\r\n    } catch (e) {\r\n      console.log(e);\r\n      message.warning({\r\n        content: '用户名或者密码错误',\r\n        style: {\r\n          fontSize: '20px',\r\n          marginTop: '5vh'\r\n        }\r\n      });\r\n    }\r\n  };\r\n}\r\n//退出登录\r\nexport function logoutAction() {\r\n  return (dispatch: any) => {\r\n    window.localStorage.clear();\r\n    dispatch(changeLoginType(0));\r\n    dispatch(\r\n      changeUserMsg({\r\n        token: '',\r\n        userName: '',\r\n        userId: '',\r\n        avatarUrl: '',\r\n        createTime: '',\r\n        updateTime: '',\r\n        manage: -1,\r\n        auth: -1\r\n      })\r\n    );\r\n    dispatch(deleteUserDetail());\r\n  };\r\n}\r\n","import request from '../request';\r\nimport store from '../../store/index';\r\n//用户喜欢歌曲\r\nexport function setUserFavorite(id: string) {\r\n  return request({\r\n    url: '/user/favorite',\r\n    method: 'post',\r\n    data: {\r\n      id\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取用户喜欢歌曲\r\nexport function getUserFavorite(offset: number, limit: number) {\r\n  return request({\r\n    url: '/user/favorite',\r\n    params: {\r\n      offset,\r\n      limit\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//取消用户喜欢\r\nexport function cancelFavorite(songId: string) {\r\n  return request({\r\n    url: '/user/favorite/cancel',\r\n    method: 'post',\r\n    data: {\r\n      songId: songId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取用户收藏\r\nexport function getUserSub(url: string, offset: number, limit: number) {\r\n  return request({\r\n    url: `/sub/user/${url}`,\r\n    params: {\r\n      offset,\r\n      limit\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取当前登录用户详情\r\nexport function getUserDetail() {\r\n  return request({\r\n    url: '/user/detail',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//上传用户头像\r\nexport function uploadAvatar(formData: FormData) {\r\n  return request({\r\n    url: '/user/upload/avatar',\r\n    method: 'post',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token,\r\n      'Content-Type': 'multipart/form-data'\r\n    },\r\n    data: formData\r\n  });\r\n}\r\n//获取其它用户详情\r\nexport function getOtherUserDetail<T>(userId: string) {\r\n  return request<T>({\r\n    url: '/user/other/detail',\r\n    method: 'post',\r\n    data: {\r\n      userId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n\r\n//获取用户创建的电台\r\nexport function getUserChannel(userId: string, offset: number, limit: number) {\r\n  return request({\r\n    url: '/user/channel',\r\n    method: 'post',\r\n    data: {\r\n      userId,\r\n      offset,\r\n      limit\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n\r\n//获取用户收藏的歌单\r\nexport function getUserSubPlaylist<T>(userId: string, offset: number, limit: number) {\r\n  return request<T>({\r\n    url: '/sub/user/playlist',\r\n    method: 'post',\r\n    params: {\r\n      offset,\r\n      limit\r\n    },\r\n    data: {\r\n      userId\r\n    }\r\n  });\r\n}\r\n//用户VIP是否·过期\r\nexport function updateUserExpire(token: string) {\r\n  return request({\r\n    url: '/user/expire',\r\n    method: 'post',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: token\r\n    }\r\n  });\r\n}\r\n//获取用户动态数据\r\nexport function getUserMomentData() {\r\n  return request({\r\n    url: '/user/data/moment',\r\n    method: 'post',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取用户全部动态\r\nexport function getUserAllMoment(offset: string, limit: string) {\r\n  return request({\r\n    url: '/user/moment',\r\n    method: 'post',\r\n    data: {\r\n      offset,\r\n      limit\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取用户简略信息\r\nexport function getSimpleUserInfo<T>(userId: string) {\r\n  return request<T>({\r\n    url: '/user/simple',\r\n    params: {\r\n      userId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n","import request from '../request';\r\n//登录\r\nexport function login(userName: string, password: string) {\r\n  return request({\r\n    url: '/login',\r\n    method: 'post',\r\n    data: {\r\n      userName,\r\n      password\r\n    }\r\n  });\r\n}\r\n//注册\r\nexport function register(userName: string, password: string) {\r\n  return request({\r\n    url: '/register',\r\n    method: 'post',\r\n    data: {\r\n      userName,\r\n      password\r\n    }\r\n  });\r\n}\r\n","/*格式化时间*/\r\nexport function formatTime(dateS: number | string, fmt: string) {\r\n  let date: Date = new Date(dateS);\r\n  if (/(y+)/.test(fmt)) {\r\n    fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));\r\n  }\r\n  let o = {\r\n    'M+': date.getMonth() + 1,\r\n    'd+': date.getDate(),\r\n    'h+': date.getHours(),\r\n    'm+': date.getMinutes(),\r\n    's+': date.getSeconds()\r\n  };\r\n  for (let k in o) {\r\n    if (new RegExp(`(${k})`).test(fmt)) {\r\n      // @ts-ignore\r\n      let str = o[k] + '';\r\n      fmt = fmt.replace(RegExp.$1, RegExp.$1.length === 1 ? str : padLeftZero(str));\r\n    }\r\n  }\r\n  return fmt || '';\r\n}\r\n\r\nfunction padLeftZero(str: string) {\r\n  return ('00' + str).substr(str.length);\r\n}\r\n","// This icon file is generated automatically.\nvar CheckOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M912 190h-69.9c-9.8 0-19.1 4.5-25.1 12.2L404.7 724.5 207 474a32 32 0 00-25.1-12.2H112c-6.7 0-10.4 7.7-6.3 12.9l273.9 347c12.8 16.2 37.4 16.2 50.3 0l488.4-618.9c4.1-5.1.4-12.8-6.3-12.8z\" } }] }, \"name\": \"check\", \"theme\": \"outlined\" };\nexport default CheckOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport CheckOutlinedSvg from \"@ant-design/icons-svg/es/asn/CheckOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CheckOutlined = function CheckOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: CheckOutlinedSvg\n  }));\n};\n\nCheckOutlined.displayName = 'CheckOutlined';\nexport default /*#__PURE__*/React.forwardRef(CheckOutlined);","import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import request from '../request';\r\nimport store from '../../store';\r\n//获取所有vip价格类型\r\nexport function getAllCombo() {\r\n  return request({\r\n    url: '/combo/all',\r\n    method: 'get',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//开通VIP\r\nexport function joinVIP(cId: string, name: string, orderId: string) {\r\n  return request({\r\n    url: '/pay/join',\r\n    method: 'post',\r\n    data: {\r\n      name,\r\n      cId,\r\n      orderId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取vip信息\r\nexport function getVipMessage() {\r\n  return request({\r\n    url: '/vip',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//获取VIP历史信息\r\nexport function getVipHistory() {\r\n  return request({\r\n    url: '/vip/history',\r\n    method: 'post',\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//删除VIP历史记录\r\nexport function deleteVIPHistory(id: string) {\r\n  return request({\r\n    url: '/vip/history/delete',\r\n    method: 'post',\r\n    data: {\r\n      id\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n","import request from '../request';\r\nimport store from '../../store';\r\nexport function payMoney(price: number, name: string, comboId: string) {\r\n  return request({\r\n    url: '/pay',\r\n    method: 'post',\r\n    data: {\r\n      price,\r\n      name,\r\n      cId: comboId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//订单状态查询\r\nexport function queryOrderAlipay(orderId: string) {\r\n  return request({\r\n    url: '/pay/query',\r\n    method: 'post',\r\n    data: {\r\n      orderId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n//订单状态查询\r\nexport function closeOrderAlipay(orderId: string) {\r\n  return request({\r\n    url: '/pay/close',\r\n    method: 'post',\r\n    data: {\r\n      orderId\r\n    },\r\n    headers: {\r\n      // @ts-ignore\r\n      authorization: store.getState().getIn(['loginReducer', 'login', 'userMsg']).token\r\n    }\r\n  });\r\n}\r\n","import styled from 'styled-components';\r\nexport const SuccessPageWrapper = styled.div`\r\n  background-color: #fff;\r\n  border-left: 1px solid #d3d3d3;\r\n  border-right: 1px solid #d3d3d3;\r\n  width: 800px;\r\n  margin: 0 auto;\r\n  padding: 100px 0 150px 0;\r\n  display: flex;\r\n  align-items: center;\r\n  flex-direction: column-reverse;\r\n  .success-icon {\r\n    border: 3px solid #f27a7a;\r\n    width: 80px;\r\n    height: 80px;\r\n    border-radius: 50%;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    .already {\r\n      color: #f27a7a;\r\n      svg {\r\n        font-size: 30px;\r\n      }\r\n    }\r\n  }\r\n  .tip {\r\n    text-align: center;\r\n    font-weight: bolder;\r\n    margin: 20px 0 0 0;\r\n  }\r\n  .success-msg {\r\n    width: 170px;\r\n    margin: 15px 0 0 0;\r\n    & > li {\r\n      text-align: center;\r\n      margin: 0 0 5px 0;\r\n      span {\r\n        margin: 0 5px 0 0;\r\n        &:nth-child(2) {\r\n          font-weight: bold;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .known {\r\n    margin: 30px 0 0 0;\r\n    background-color: #fb5e5a;\r\n    color: #fff;\r\n    padding: 5px 70px;\r\n    border-radius: 15px;\r\n    cursor: pointer;\r\n  }\r\n`;\r\n","import React, { memo, ReactElement, FC, useEffect, useState } from 'react';\r\nimport { Map } from 'immutable';\r\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { CheckOutlined } from '@ant-design/icons';\r\nimport { SuccessPageWrapper } from './style';\r\nimport { parseURL } from '../../utils/parseURL';\r\nimport { queryOrderAlipay } from '../../network/pay';\r\nimport { getVipMessage, joinVIP } from '../../network/vip';\r\nimport { formatTime } from '../../utils/format';\r\n\r\nimport { changeUserMsg } from '../Login/store/actionCreators';\r\nimport { ILogin, IUserMsg } from '../../constant/store/login';\r\n\r\nconst SuccessPage: FC<RouteComponentProps> = (props): ReactElement => {\r\n  const [params, setParams] = useState<any>({});\r\n  const [tmpParams, setTmpParams] = useState<any>({});\r\n  const { userMsg } = useSelector<Map<string, ILogin>, { userMsg: IUserMsg }>((state) => ({\r\n    userMsg: state.getIn(['loginReducer', 'login', 'userMsg'])\r\n  }));\r\n  const dispatch = useDispatch();\r\n  useEffect(() => {\r\n    const params = parseURL(window.location.href);\r\n    setParams(params);\r\n    tmpParams.price = params.out_trade_no.split('_')[1];\r\n    tmpParams.name = params.out_trade_no.split('_')[2] + '个月';\r\n    tmpParams.expireTime =\r\n      new Date().getTime() + parseInt(params.out_trade_no.split('_')[2]) * 60 * 60 * 24 * 30 * 1000;\r\n    setTmpParams(tmpParams);\r\n    queryOrderAlipay(params.out_trade_no).then((data: any) => {\r\n      const { code } = data;\r\n      if (code * 1 === 10000) {\r\n        const cId = params.out_trade_no.split('_')[0];\r\n        joinVIP(cId, tmpParams.name, params.orderId).then((data) => {\r\n          getVipMessage().then((data: any) => {\r\n            data.token = userMsg.token;\r\n            dispatch(changeUserMsg(data));\r\n            window.localStorage.setItem('userMsg', JSON.stringify(data));\r\n          });\r\n        });\r\n      }\r\n    });\r\n  }, [dispatch, tmpParams, userMsg.token]);\r\n\r\n  const known = () => {\r\n    props.history.push({\r\n      pathname: '/Home/discover/recommend'\r\n    });\r\n  };\r\n  return (\r\n    <SuccessPageWrapper>\r\n      <div className=\"known\" onClick={(e) => known()}>\r\n        知道了\r\n      </div>\r\n      {Object.keys(tmpParams).length && (\r\n        <ul className=\"success-msg\">\r\n          <li>\r\n            <span>实付金额 :</span>\r\n            <span>{params.total_amount}</span>\r\n          </li>\r\n          <li>\r\n            <span>购买会员 :</span>\r\n            <span>{tmpParams.name}</span>\r\n          </li>\r\n          <li>\r\n            <span>到期时间 :</span>\r\n            <span>{formatTime(tmpParams.expireTime, 'yyyy-MM-dd')}</span>\r\n          </li>\r\n        </ul>\r\n      )}\r\n      <p className=\"tip\">开通成功</p>\r\n      <div className=\"success-icon\">\r\n        <CheckOutlined className=\"already\" />\r\n      </div>\r\n    </SuccessPageWrapper>\r\n  );\r\n};\r\nexport default withRouter(memo(SuccessPage));\r\n","export function parseURL(url: string) {\r\n  if (!url.includes('?')) {\r\n    return '';\r\n  } else {\r\n    let params = url.substring(url.lastIndexOf('?') + 1);\r\n    let paramsArr = params.split('&');\r\n    let res: any = {};\r\n    for (let item of paramsArr) {\r\n      let param = item.split('=');\r\n      res[param[0]] = param[1].toString();\r\n    }\r\n    return res;\r\n  }\r\n}\r\n","/*\r\n@Name guobin\r\n@Description gb-music\r\n@author guobin\r\n@date 2021/9/21\r\n*/\r\nimport axios, { AxiosInstance, AxiosRequestConfig } from 'axios';\r\nimport { HOST_NAME } from '../config';\r\nimport store from '../store';\r\nimport { changeUserMsg, logoutAction } from '../views/Login/store/actionCreators';\r\nimport { createBrowserHistory } from 'history';\r\nfunction request<T>(config: AxiosRequestConfig) {\r\n  const instance: AxiosInstance = axios.create({\r\n    baseURL: HOST_NAME,\r\n    timeout: 15000\r\n  });\r\n  instance.interceptors.request.use(\r\n    (config) => {\r\n      return config;\r\n    },\r\n    (err) => {\r\n      console.log(err);\r\n      return err;\r\n    }\r\n  );\r\n  instance.interceptors.response.use(\r\n    (res) => {\r\n      return res.data;\r\n    },\r\n    (err) => {\r\n      if (err.response) {\r\n        const { status, data } = err.response;\r\n        if (status * 1 === 403 && data.message === '请登录') {\r\n          // @ts-ignore\r\n          store.dispatch(logoutAction());\r\n          store.dispatch(\r\n            changeUserMsg({\r\n              token: '',\r\n              userName: '',\r\n              userId: '',\r\n              avatarUrl: '',\r\n              createTime: '',\r\n              updateTime: '',\r\n              manage: -1,\r\n              auth: -1\r\n            })\r\n          );\r\n          createBrowserHistory().push({\r\n            pathname: '/Login'\r\n          });\r\n        } else {\r\n          throw err;\r\n        }\r\n      }\r\n    }\r\n  );\r\n  return instance.request<any, T>(config);\r\n}\r\nexport default request;\r\n"],"sourceRoot":""}